<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Categories</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="font-sans bg-gray-100 flex flex-col min-h-screen">
    <nav class="bg-yellow-400 p-4 text-black">
        <div class="flex justify-between items-center">
            <h1 class="text-2xl font-semibold">Category Dashboard</h1>
            <div class="flex space-x-4">
                <a href="dashboard.html" class="hover:text-gray-300">Back to Dashboard</a>
            </div>
        </div>
    </nav>

    <div id="app" class="container mx-auto p-8 flex-1">

        <h1 class="text-3xl font-semibold mb-4 text-center">Categories List</h1>

        <!-- Form to Create a New Category -->
        <form @submit.prevent="createCategory" class="max-w-md mx-auto bg-gray-200 p-4 rounded-lg shadow-md mb-8">
            <label for="categoryName" class="block text-sm font-medium text-gray-700 mb-2">New Category Name:</label>
            <div class="flex">
                <input v-model="newCategoryName" type="text" id="categoryName" name="categoryName"
                    class="p-2 border rounded-md w-full focus:outline-none focus:ring focus:border-blue-300">
                <button type="submit"
                    class="ml-2 bg-yellow-400 text-black px-4 py-2 rounded-md focus:outline-none hover:bg-yellow-600">Create
                    Category</button>
            </div>
        </form>

        <!-- List of Categories as Cards -->
        <div class="flex flex-wrap -mx-4">
            <div v-for="category in categories" :key="category.id" class="w-full sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/5 px-4 mb-4">
                <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                    <h2 class="text-xl font-semibold mb-2">{{ category.name }}</h2>
                    <p class="text-gray-600">Category description</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-yellow-400 p-4 text-center">
        <p class="text-gray-700">Â© 2024 Categories Dashboard. All rights reserved.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            new Vue({
                el: '#app',
                data: {
                    categories: [], // Array to store categories
                    newCategoryName: '' // Variable to store the new category name
                },
                mounted() {
                    // Fetch categories from the API
                    fetch('/api/category')
                        .then(response => response.json())
                        .then(data => {
                            this.categories = data;
                        })
                        .catch(error => {
                            console.error('Error fetching categories:', error);
                        });
                },
                methods: {
                    createCategory() {
                        // Check if the newCategoryName is not empty
                        if (this.newCategoryName.trim() !== '') {
                            // Send a POST request to create a new category
                            fetch('/api/category', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/x-www-form-urlencoded',
                                },
                                body: new URLSearchParams({
                                    name: this.newCategoryName
                                })
                            })
                                .then(response => response.text())
                                .then(message => {
                                    // Display a success message
                                    alert(message);
                                    // Clear the input field
                                    this.newCategoryName = '';
                                    // Refresh the list of categories
                                    this.fetchCategories();
                                })
                                .catch(error => {
                                    console.error('Error creating category:', error);
                                });
                        } else {
                            // Display an error message if the input is empty
                            alert('Please enter a category name.');
                        }
                    },
                    fetchCategories() {
                        // Fetch updated categories after creating a new one
                        fetch('/api/category')
                            .then(response => response.json())
                            .then(data => {
                                this.categories = data;
                            })
                            .catch(error => {
                                console.error('Error fetching categories:', error);
                            });
                    }
                }
            });
        });
    </script>
</body>

</html>
